- url = "http://maps.google.com/maps"
- url += "?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q="
- url += "#{@fall.details[:latitude]}+#{@fall.details[:longitude]}"
- url += "&amp;aq=&amp;sll="
- url += "#{@fall.details[:latitude]},#{@fall.details[:longitude]}"
- url += "&amp;ie=UTF8&amp;z=16&amp;ll="
- url += "#{@fall.details[:latitude]},#{@fall.details[:longitude]}"
- url += "&amp;output=embed"

%iframe{:width => "640",
        :height => "480",
        :frameborder => "0",
        :scrolling => "no",
        :marginheight => "0",
        :marginwidth => "0",
        :src => url}
%br
%small
  - link_url = "http://maps.google.com/maps"
  - link_url += "?f=q&amp;source=embed&amp;hl=en&amp;geocode=&amp;q="
  - link_url += "#{@fall.details[:latitude]}+#{@fall.details[:longitude]}"
  - link_url += "&amp;aq=&amp;sll="
  - link_url += "#{@fall.details[:latitude]},#{@fall.details[:longitude]}"
  - link_url += "&amp;sspn=0.003255,0.00809&amp;ie=UTF8&amp;z=16&amp;ll="
  - link_url += "#{@fall.details[:latitude]},#{@fall.details[:longitude]}"
  %a{:href => link_url, :style => "color: #0000FF; text-align: left"}View Larger Map


:javascript

  function refresh_falls() {  
    $.get('/falls/refresh', function(data) {
      if (data > 0)
        window.location = "/"
    });    
  }

  $(document).ready(function(){
    setInterval('refresh_falls()', 2000)
  })